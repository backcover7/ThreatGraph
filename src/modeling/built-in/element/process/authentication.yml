module:
  process:
    - metadata:
        name: Password Authn
        description: Authentication uses password as credential
        icon: data:image/svg+xml;base64,YQ==
        type: password
      tags: [ authentication ]
      attributes:
        critical: 3
        operation: w
      additions:
        password:
          strong:
            type: boolean
            description: Whether password is required to be strong enough
          expiration:
            type: boolean
            description: Whether password has expiration
        antiAbuse:
          type: boolean
          description: Whether brute force attack is prevented

    - metadata:
        name: OAuth2
        description: OAuth2 Authentication
        icon: data:image/svg+xml;base64,YQ==
        type: oauth2
      tags: [ authentication ]
      attributes:
        critical: 3
        operation: w

    - metadata:
        name: SSO
        description: SSO Authentication
        icon: data:image/svg+xml;base64,YQ==
        type: sso
      tags: [ authentication ]
      attributes:
        critical: 3
        operation: w

  rule:
    - id: 488dc7ab-928f-407d-b995-45f91e4b7afc
      threat: 461c0696-9811-413b-98ff-f5073f7b88a3  # Weak credential policy
      element: process
      analyze:
        - design: metadata.type = 'password'
        - design: additions.password.strong = false

    - id: 3dd6d4bf-f281-47af-aa26-ce56e9a11957
      threat: e1f06cab-4818-4c49-ace3-00a46f9e0e91  # Never expired credential
      element: process
      analyze:
        - design: metadata.type = 'password'
        - design: additions.password.expiration = false

    - id: 14b841f4-60ba-4682-99d3-6538fc06d5a2
      threat: 9e85bda8-1858-407c-8c2a-67a2496b3c9a  # Brute force attack
      element: process
      analyze:
        - design: metadata.type = 'password'
        - design: additions.antiAbuse = false